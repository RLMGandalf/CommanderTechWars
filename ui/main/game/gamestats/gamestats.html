<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <noloc><title>Live Game: Stats</title></noloc>
    <script src="coui://ui/main/shared/js/common.js" type="text/javascript"></script>
    <script src="coui://ui/main/shared/js/thirdparty/flot/jquery.flot.min.js" type="text/javascript"></script>
    <script src="gamestats.js" type="text/javascript"></script>
    <link href="coui://ui/main/shared/css/global.css" rel="stylesheet" type="text/css" />
    <link href="coui://ui/main/game/game_over/game_over.css" rel="stylesheet" type="text/css" />
    <link href="gamestats.css" rel="stylesheet" type="text/css" />
</head>

<body class="body_panel" data-bind="click: maybeExitStats">
    <div style="height: 100%; width: 100%; display: flex; align-items: center; justify-content: center; background: rgba(0,0,0,.5);">
        <div class="div_panel_bar_background summary">
            <div class="div_end_game_msg">
                <div class="end_msg summary">
                    <loc data-i18n="gamestats:game_summary.message" desc="">GAME SUMMARY</loc>
                </div>
                <!-- ko if: gameIsOnGoing -->
                <div class="username summary"><loc data-i18n="gamestats:in_progress.message" desc="">In Progress</loc></div>
                <!-- /ko -->

                <!-- ko ifnot: gameIsOnGoing -->
                <div class="username summary">
                    <!-- ko if: (model.victors().length == 1) -->
                    <span><loc data-i18n="gamestats:winner.message" desc="">Winner:</loc></span>
                    <!-- /ko -->

                    <!-- ko if: (model.victors().length > 1) -->
                    <span><loc data-i18n="gamestats:winners.message" desc="">Winners:</loc></span>
                    <!-- /ko -->

                    <!-- ko ifnot: (model.victors().length) -->
                    <span><loc data-i18n="gamestats:draw.message" desc="">Draw</loc></span>
                    <!-- /ko -->
                    <noloc>&nbsp;</noloc>
                    <!-- ko foreach: victors -->
                    <span data-bind="text: $data"></span>
                    <span data-bind="visible: ($index() !== model.victors().length - 1)">,&nbsp;</span>
                    <!-- /ko -->
                </div>
                <!-- /ko -->
            </div>

            <div class="div_game_summary_panel" data-bind="click: preventExitStats">
                <div class="div_game_summary">
                    <!-- TABLE -->
                    <div class="container" style="height:100%; width:100%;" data-bind="visible: (!model.showGraph())">
                        <div style="display:flex; justify-content:center;">
                            <ul id="stats_tabs" class="nav nav-pills">
                                <li class="btn_std_ix  active">
                                    <a href="#current" data-toggle="pill" data-bind="click_sound: 'default', rollover_sound: 'default'">
                                        <loc data-i18n="gamestats:current.message" desc="">Current</loc>
                                    </a>
                                </li>
                                <li class="btn_std_ix ">
                                    <a href="#total" data-toggle="pill" data-bind="click_sound: 'default', rollover_sound: 'default'">
                                        <loc data-i18n="gamestats:total.message" desc="">Total</loc>
                                    </a>
                                </li>
                            </ul>
                        </div>
                        <div class="tab-content" style="border-top:1px solid #333; margin-top:-2px;">
                            <div class="tab-pane active" id="total">
                                <table class="game_summary">
                                    <tbody>
                                        <!-- COLUMN GROUP LABELS -->
                                        <tr class="header_categories">
                                            <td style="width:200px;"></td>
                                            <td class="border" style="width: 135px;"><loc data-i18n="gamestats:total_efficiency.message" desc="">Total Efficiency</loc></td>
                                            <td colspan="3" class="border"><loc data-i18n="gamestats:total_metal.message" desc="">Total Metal</loc></td>
                                            <td colspan="3" class="border"><loc data-i18n="gamestats:total_energy.message" desc="">Total Energy</loc></td>
                                            <td colspan="4" class="border"><loc data-i18n="gamestats:total_units.message" desc="">Total Units</loc></td>
                                            <td class="border"><loc data-i18n="gamestats:total_apm.message" desc="">Total APM</loc></td>
                                        </tr>

                                        <!-- COLUMN HEADERS -->
                                        <tr style="color:#999;">
                                            <!--USERNAME COL -->
                                            <th style="min-width: 120px;"></th>

                                            <!--EFFICIENCY COL -->
                                            <th class="border"><loc data-i18n="gamestats:avg.message" desc="">Avg</loc></th>

                                            <!--METAL COLS -->
                                            <th class="border"><loc data-i18n="gamestats:produced.message" desc="">Produced</loc></th>
                                            <th><loc data-i18n="gamestats:consumed.message" desc="">Consumed</loc></th>
                                            <th><loc data-i18n="gamestats:wasted.message" desc="">Wasted</loc></th>
                                    
                                            <!--ENERGY COLS -->
                                            <th class="border"><loc data-i18n="gamestats:produced.message" desc="">Produced</loc></th>
                                            <th><loc data-i18n="gamestats:consumed.message" desc="">Consumed</loc></th>
                                            <th><loc data-i18n="gamestats:wasted.message" desc="">Wasted</loc></th>
                                    
                                            <!--UNIT COLS -->
                                            <th class="border"><loc data-i18n="gamestats:created.message" desc="">Created</loc></th>
                                            <th><loc data-i18n="gamestats:lost.message" desc="">Lost</loc></th>
                                            <th><loc data-i18n="gamestats:opp_killed.message" desc="">Opp Killed</loc></th>
                                            <th></th>
                                    
                                            <!--APM COL -->
                                            <th class="border"><loc data-i18n="gamestats:avg.message" desc="">Avg</loc></th>

                                        </tr>

                                        <!-- ko foreach: latestAggregateSummary -->

                                        <!-- PLAYER ROW -->
                                        <tr class="player">
                                            <!--USERNAME COL -->
                                            <td> 
                                                <span class="team_color" data-bind="style: { 'background-color': model.armyColors()[$index()] }"></span>
                                                <span class="team_username" data-bind="text: model.armyNames()[$index()]"></span>
                                            </td>

                                            <!-- ko if: (model.availableVisionFlags()[$index()]) -->

                                            <!--EFFICIENCY COL -->
                                            <td class="stat stat_num border"><span data-bind="text: $data.efficiency.toFixed(1)"></span>%</td>

                                            <!--METAL COLS -->
                                            <td class="stat stat_num border"><span data-bind="text: $data.metal_produced.toFixed(1)"></span></td>
                                            <td class="stat stat_num"><span data-bind="text: ($data.metal_produced - $data.metal_wasted).toFixed(1)"></span></td>
                                            <td class="stat stat_num"><span data-bind="text: $data.metal_wasted.toFixed(1)"></span></td>
                                    
                                            <!--ENERGY COLS -->
                                            <td class="stat stat_num border"><span data-bind="text: $data.energy_produced.toFixed(1)"></span></td>
                                            <td class="stat stat_num"><span data-bind="text: ($data.energy_produced - $data.energy_wasted).toFixed(1)"></span></td>
                                            <td class="stat stat_num"><span data-bind="text: $data.energy_wasted.toFixed(1)"></span></td>
                                    
                                            <!--UNIT COLS -->
                                            <td class="stat stat_num border"><span data-bind="text: $data.units_build"></span></td>
                                            <td class="stat stat_num"><span data-bind="text: $data.units_lost"></span></td>
                                            <td class="stat stat_num"><span data-bind="text: $data.units_destroyed"></span></td>
                                            <td class="stat stat_num"></td>
                                    
                                            <!--APM COL -->
                                            <td class="stat stat_num border"><span data-bind="text: $data.commands_given_delta.toFixed(1)"></span></td>    

                                            <!-- /ko -->


                                            <!-- ko ifnot: (model.availableVisionFlags()[$index()]) -->

                                            <!--EFFICIENCY COL -->
                                            <td class="stat border"><span>-</span></td>

                                            <!--METAL COLS -->
                                            <td class="stat border"><span>-</span></td>
                                            <td class="stat"><span>-</span></td>
                                            <td class="stat"><span>-</span></td>
                                    
                                            <!--ENERGY COLS -->
                                            <td class="stat border"><span>-</span></td>
                                            <td class="stat"><span>-</span></td>
                                            <td class="stat"><span>-</span></td>
                                    
                                            <!--UNIT COLS -->
                                            <td class="stat border"><span>-</span></td>
                                            <td class="stat"><span>-</span></td>
                                            <td class="stat"><span>-</span></td>
                                            <td class="stat"><span></span></td>
                                    
                                            <!--APM COL -->
                                            <td class="stat border"><span>-</span></td>

                                            <!-- /ko -->
                                        </tr>

                                        <!-- /ko -->
                                    </tbody>
                                </table>
                            </div>
                            <div class="tab-pane" id="current">
                                <table class="game_summary">
                                    <tbody>
                                        <!-- COLUMN GROUP LABELS -->
                                        <tr class="header_categories">
                                            <td style="width:200px;"></td>
                                            <td class="border" style="width: 135px;"><loc data-i18n="gamestats:current_efficiency.message" desc="">Current Efficiency</loc></td>
                                            <td colspan="3" class="border"><loc data-i18n="gamestats:current_metal.message" desc="">Current Metal</loc></td>
                                            <td colspan="3" class="border"><loc data-i18n="gamestats:current_energy.message" desc="">Current Energy</loc></td>
                                            <td colspan="4" class="border"><loc data-i18n="gamestats:current_units.message" desc="">Current Units</loc></td>
                                            <td class="border"><loc data-i18n="gamestats:current_apm.message" desc="">Current APM</loc></td>
                                        </tr>

                                        <!-- COLUMN HEADERS -->
                                        <tr style="color:#999;">
                                            <!--USERNAME COL -->
                                            <th style="min-width: 120px;"></th>

                                            <!--EFFICIENCY COL -->
                                            <th class="border"><loc data-i18n="gamestats:current.message" desc="">Current</loc></th>

                                            <!--METAL COLS -->
                                            <th class="border"><loc data-i18n="gamestats:produced.message" desc="">Produced</loc></th>
                                            <th><loc data-i18n="gamestats:consumed.message" desc="">Consumed</loc></th>
                                            <th><loc data-i18n="gamestats:wasted.message" desc="">Wasted</loc></th>
                                    
                                            <!--ENERGY COLS -->
                                            <th class="border"><loc data-i18n="gamestats:produced.message" desc="">Produced</loc></th>
                                            <th><loc data-i18n="gamestats:consumed.message" desc="">Consumed</loc></th>
                                            <th><loc data-i18n="gamestats:wasted.message" desc="">Wasted</loc></th>
                                    
                                            <!--UNIT COLS -->
                                            <th class="border"><loc data-i18n="gamestats:total.message" desc="">Total</loc></th>
                                            <th><loc data-i18n="gamestats:factory.message" desc="">Factory</loc></th>
                                            <th><loc data-i18n="gamestats:fab.message" desc="">Fab</loc></th>
                                            <th><loc data-i18n="gamestats:mobile.message" desc="">Mobile</loc></th>
                                    
                                            <!--APM COL -->
                                            <th class="border"><loc data-i18n="gamestats:current.message" desc="">Current</loc></th>

                                        </tr>

                                        <!-- ko foreach: latestSnapshotSummary -->

                                        <!-- PLAYER ROW -->
                                        <tr class="player">
                                            <!--USERNAME COL -->
                                            <td> 
                                                <span class="team_color" data-bind="style: { 'background-color': model.armyColors()[$index()] }"></span>
                                                <span class="team_username" data-bind="text: model.armyNames()[$index()]"></span>
                                            </td>

                                            <!-- ko if: (model.availableVisionFlags()[$index()]) -->

                                            <!--EFFICIENCY COL -->
                                            <td class="stat stat_num border"><span data-bind="text: $data.efficiency.toFixed(1)"></span>%</td>

                                            <!--METAL COLS -->
                                            <td class="stat stat_num border"><span data-bind="text: $data.metal_produced.toFixed(1)"></span></td>
                                            <td class="stat stat_num"><span data-bind="text: $data.metal_demand.toFixed(1)"></span></td>
                                            <td class="stat stat_num"><span data-bind="text: $data.metal_wasted.toFixed(1)"></span></td>
                                    
                                            <!--ENERGY COLS -->
                                            <td class="stat stat_num border"><span data-bind="text: $data.energy_produced.toFixed(1)"></span></td>
                                            <td class="stat stat_num"><span data-bind="text: $data.energy_demand.toFixed(1)"></span></td>
                                            <td class="stat stat_num"><span data-bind="text: $data.energy_wasted.toFixed(1)"></span></td>
                                    
                                            <!--UNIT COLS -->
                                            <td class="stat stat_num border"><span data-bind="text: $data.army_count"></span></td>
                                            <td class="stat stat_num"><span data-bind="text: $data.army_count_fabber"></span></td>
                                            <td class="stat stat_num"><span data-bind="text: $data.army_count_factory"></span></td>
                                            <td class="stat stat_num"><span data-bind="text: $data.army_count_mobile"></span></td>
                                    
                                            <!--APM COL -->
                                            <td class="stat stat_num border"><span data-bind="text: $data.commands_given_delta"></span></td>

                                            <!-- /ko -->

                                            <!-- ko ifnot: (model.availableVisionFlags()[$index()]) -->

                                            <!--EFFICIENCY COL -->
                                            <td class="stat border"><span>-</span></td>

                                            <!--METAL COLS -->
                                            <td class="stat border"><span>-</span></td>
                                            <td class="stat"><span>-</span></td>
                                            <td class="stat"><span>-</span></td>
                                    
                                            <!--ENERGY COLS -->
                                            <td class="stat border"><span>-</span></td>
                                            <td class="stat"><span>-</span></td>
                                            <td class="stat"><span>-</span></td>
                                    
                                            <!--UNIT COLS -->
                                            <td class="stat border"><span>-</span></td>
                                            <td class="stat"><span>-</span></td>
                                            <td class="stat"><span>-</span></td>
                                            <td class="stat"><span>-</span></td>
                                    
                                            <!--APM COL -->
                                            <td class="stat border"><span>-</span></td>

                                            <!-- /ko -->
                                        </tr>

                                        <!-- /ko -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <!--- GRAPH -->
                    <div id="graph_container" style="display:flex;" data-bind="visible: showGraph">
                        <table>
                            <tbody>
                                <tr>
                                    <td style="border-right: 1px solid #333;">
                                        <div class="div_army_select_cont">
                                            <!-- ko foreach: activeData -->
                                            <div class="control_army_select">
                                                <label class="btn_std_ix" data-bind="click: function () { model.toggleActiveData($index()) }">
                                                    <!-- ko if: (model.availableVisionFlags()[$index()]) -->
                                                    <input type="checkbox" data-bind="checked: model.activeData()[$index()]" style="margin: 4px 2px 0px 10px; pointer-events: none" />
                                                    <!-- /ko -->

                                                    <!-- ko ifnot: (model.availableVisionFlags()[$index()]) -->
                                                    <input type="checkbox" data-bind="checked: model.activeData()[$index()]" style="margin: 4px 2px 0px 10px;" disabled />
                                                    <!-- /ko -->

                                                    <span class="team_color" data-bind="style: { background: model.armyColors()[$index()] }"></span>
                                                    <span class="control_username" data-bind="text: model.armyNames()[$index()]"></span>
                                                </label>
                                            </div>
                                            <!-- /ko -->
                                        </div>
                                    </td>
                                    <td style="padding-left:10px;">
                                        <div id="stat-select-cont" data-bind="foreach: definitions">
                                            <div class="one-stat-selector btn_std_ix"
                                                data-bind="text: $data.label,
                                                click: function () { $parent.selectedStat($data.name) },
                                                css: { selected: $parent.selectedStat() === $data.name }">
                                            </div>
                                        </div>
                                    </td>
                                    <td style="width:100%;">
                                        <div id="graph" style="height:100%; width:100%; position:absolute;"></div>
                                    </td>
                                </tr>
                                <!-- ko if: false -->
                                <tr>
                                    <td colspan="3">
                                        <div style="height: 20px; width: 100%; display: flex; justify-content: center; margin-top: 12px; font-family: 'Sansation Bold'; font-size: 16px; color: #00ff00;">
                                            <img style="height: 24px; width: 24px; margin: -5px 8px 0px 0px;" src="../../shared/img/loading.gif" /><loc data-i18n="gamestats:retrieving_stats.message" desc="">Retrieving Stats...</loc>
                                        </div>
                                    </td>
                                </tr>
                                <!-- /ko -->
                            </tbody>
                        </table>

                    </div>
                </div>
                <div class="div_stats_panel_options" style="margin:0px 0px 20px 0px;">
                    <div>
                        <!-- ko if: showGraph -->
                        <input type="button" style="width:360px;" locattr="value" value="View Box Score" id="Button1" class="" data-bind="click: toggleShowGraph, click_sound: 'default', rollover_sound: 'default'" />
                        <!-- /ko -->

                        <!-- ko ifnot: showGraph -->
                        <input type="button" style="width:360px;" locattr="value" value="View Graph Analysis" id="Button2" class="" data-bind="click: toggleShowGraph, click_sound: 'default', rollover_sound: 'default'" />
                        <!-- /ko -->
                    </div>
                    <div>
                        <input type="button" locattr="value" value="CLOSE" id="" class="" data-bind="click: close, click_sound: 'default', rollover_sound: 'default'" />
                    </div>
                </div>
            </div>




        </div>
    </div>



</body>

</html>
